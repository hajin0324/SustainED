<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>ESG</title>
    <script src="JS/jquery.js"></script>
    <link rel="stylesheet" href="CSS/University.css"> 
    <!-- Google Web Fonts -->
    <link rel="preconnect" href="https://fonts.gstatic.com" />
    <link href="https://fonts.googleapis.com/css2?family=Oswald:wght@400;500;600;700&family=Rubik&display=swap" rel="stylesheet"/>

    <link rel="preconnect" href="https://fonts.googleapis.com"> 
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin> 
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@700&family=Sunflower&display=swap" rel="stylesheet"> 

    <link href="https://fonts.googleapis.com/css2?family=Alumni+Sans+Inline+One:ital@1&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Alumni+Sans+Inline+One:ital@1&family=Gowun+Dodum&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Gowun+Dodum&display=swap" rel="stylesheet">
  </head>
  <body>
    <header>
      <nav class="des">
        <a href="index.html"><h1 class="name">SUSTAINED</h1></a>
        <div class="menu-wrap">
          <p class="menu"><a href="about.html">ABOUT SDGS</a></p>
          <p class="menu"><a href="goals.html">OUR 17 GOALS</a></p>
          <p class="menu"><a href="fivep.html">WHAT IS 5P</a></p>
        </div>
      </nav>
      <hr>
    </header>

    <h2 class="university">세종대학교 SDGs 분석 결과</h2>
    <main>
      <section id="ranking">
        <p id="impact">Impact ranking score</p>
        <div id="content">
          <div>
            <p id="score">71.9점</p>
          </div>
          <div>
            <svg id="myGraph"></svg>
            <script src="https://d3js.org/d3.v4.min.js"></script>
            <script>
              var dataset = [
                { x: "2020", y: '' },
                { x: "2021", y: 47.5 },
                { x: "2022", y: 71.9 },
              ];
              var svg = d3.select("#myGraph");
              var width = parseInt(svg.style("width"), 10) - 30;
              var height = parseInt(svg.style("height"), 10) - 30;
              var svgG = svg.append("g").attr("transform", "translate(30, 0)");

              var xScale = d3
                .scaleBand()
                .domain(
                  dataset.map(function (d) {
                    return d.x;
                  })
                )
                .range([0, width])
                .padding(0.4);
              var yScale = d3
                .scaleLinear()
                .domain([60, 100])
                .range([height, 10]);

              var scale = d3.scaleOrdinal().range(["#FFAA17"]);

              svgG
                .append("g")
                .attr("transform", "translate(0," + height + ")")
                .call(d3.axisBottom(xScale));
              /* y축 표시 */
              svgG
                .append("g")
                .attr("class", "grid")
                .call(d3.axisLeft(yScale).ticks(10));

              var barG = svgG.append("g");
              /* 막대 표시 */
              barG
                .selectAll("rect")
                .data(dataset)
                .enter()
                .append("rect")
                .attr("class", "bar")
                .attr("height", function (d, i) {
                  return height - yScale(d.y);
                })
                .attr("width", xScale.bandwidth())
                .attr("x", function (d, i) {
                  return xScale(d.x);
                })
                .attr("y", function (d, i) {
                  return yScale(d.y);
                })
                .attr("fill", function (d) {
                  return scale(d.x);
                });
              /* score 표시 */
              barG
                .selectAll("text")
                .data(dataset)
                .enter()
                .append("text")
                .text(function (d) {
                  return d.y;
                })
                .attr("class", "scoreText")
                .attr("x", function (d, i) {
                  return xScale(d.x) + xScale.bandwidth() / 2;
                })
                .style("text-anchor", "middle")
                .attr("y", function (d, i) {
                  return yScale(d.y) + 28;
                });
            </script>
          </div>
        </div>
      </section>
      <div id="piechart">
        <script src="https://d3js.org/d3.v5.min.js"></script>
        <script>
          var width = 750,
            height = 500;
          var colors = d3.scaleOrdinal(d3.schemeSet3);
          /* var colors = d3.scaleOrdinal(d3.schemeCategory20,Dark2,Set2,Pastel1,Paired); */
          var svg = d3
            .select("#piechart")
            .append("svg")
            .attr("width", width)
            .attr("height", height);
          /*                         .style("background", "pink"); */
          var details = [
            { keyword: "사람", number: "36" },
            { keyword: "지구", number: "5" },
            { keyword: "번영", number: "53" },
            { keyword: "평화", number: "4" },
            { keyword: "협력", number: "3" },
          ];
          var data = d3
            .pie()
            .sort(null)
            .value(function (d) {
              return d.number;
            })(details);
          var segments = d3.arc().innerRadius(0).outerRadius(200);
          /* .padAngle(0.05)
                           .padRadius(50); */
          var sections = svg
            .append("g")
            .attr("transform", "translate(300, 250)")
            .selectAll("path")
            .data(data);
          sections
            .enter()
            .append("path")
            .attr("d", segments)
            .attr("fill", function (d) {
              return colors(d.data.number);
            })
            .attr("stroke", "white")
            .style("stroke-width", "2px");

          var content = d3
            .select("#piechart")
            .select("g")
            .selectAll("text")
            .data(data);
          content
            .enter()
            .append("text")
            .classed("pie-inside", true)
            .each(function (d) {
              var center = segments.centroid(d);
              d3.select(this)
                .attr("x", center[0]-8)
                .attr("y", center[1])
                .text(d.data.number);
            });

          var legends = svg
            .append("g")
            .attr("transform", "translate(580, 40)")
            .selectAll(".legends")
            .data(data);
          var legend = legends
            .enter()
            .append("g")
            .classed("legends", true)
            .attr("transform", function (d, i) {
              return "translate(0," + (i + 1) * 40 + ")";
            });

          legend
            .append("rect")
            .attr("width", 20)
            .attr("height", 20)
            .attr("fill", function (d) {
              return colors(d.data.number);
            });
          legend
            .append("text")
            .classed("pielabel", true)
            .text(function (d) {
              return d.data.keyword;
            })
            .attr("x", 40)
            .attr("y", 16);
        </script>
      </div>
    </main>
    <div>
      <svg id="key-legend">
        <g>
          <rect x="20" y="65" width="48" height="8" fill="#9ACA7C"></rect>
          <text x="80" y="76">현재 대학 점수</text>
          <rect x="220" y="65" width="48" height="8" fill="red"></rect>
          <text x="280" y="76">해외 TOP 50 평균</text>
          <rect x="450" y="65" width="48" height="8" fill="blue"></rect>
          <text x="510" y="76">국내 평균</text>
        </g>
      </svg>
    </div>
    <article id="keyword-compare">
      <button class="keygraph" value="people">
        <p class="keyword">사람</p>
        <svg id="svg1"></svg>
        <script src="http://d3js.org/d3.v3.js"></script>
        <script>
          var data = [80.1, 64.2];
          var color = ["red", "blue"];

          d3.select("#svg1")
            .append("rect")
            .attr("rx", 1)
            .attr("height", 26)
            .attr("width", 260)
            .attr("y", 20)
            .attr("fill", "#CCCCCC");

          d3.select("#svg1")
            .append("rect")
            .attr("rx", 1)
            .attr("height", 26)
            .attr("width", (36 * 260) / 100)
            .attr("y", 20)
            .attr("fill", "#9ACA7C");

          d3.select("#svg1")
            .append("g")
            .selectAll("rect")
            .data(data)
            .enter()
            .append("rect")
            .attr("height", 26)
            .attr("x", (d) => (d * 260) / 100)
            .attr("y", 20)
            .attr("class", (d, i) => color[i])
            .attr("width", 4);
        </script>
      </button>
      <button class="keygraph" value="planet">
        <p class="keyword">지구</p>
        <svg id="svg2"></svg>
        <script src="http://d3js.org/d3.v3.js"></script>
        <script>
          var data = [83.9, 56.2];
          var color = ["red", "blue"];

          d3.select("#svg2")
            .append("rect")
            .attr("rx", 1)
            .attr("height", 26)
            .attr("width", 260)
            .attr("y", 20)
            .attr("fill", "#CCCCCC");

          d3.select("#svg2")
            .append("rect")
            .attr("rx", 1)
            .attr("height", 26)
            .attr("width", (5 * 260) / 100)
            .attr("y", 20)
            .attr("fill", "#FFFFBC");

          d3.select("#svg2")
            .append("g")
            .selectAll("rect")
            .data(data)
            .enter()
            .append("rect")
            .attr("height", 26)
            .attr("x", (d) => (d * 260) / 100)
            .attr("y", 20)
            .attr("class", (d, i) => color[i])
            .attr("width", 4);
        </script>
      </button>
      <button class="keygraph" value="prosperity">
        <p class="keyword">번영</p>
        <svg id="svg3"></svg>
        <script src="http://d3js.org/d3.v3.js"></script>
        <script>
          var data = [83.8, 56.2];
          var color = ["red", "blue"];

          d3.select("#svg3")
            .append("rect")
            .attr("rx", 1)
            .attr("height", 26)
            .attr("width", 260)
            .attr("y", 20)
            .attr("fill", "#CCCCCC");

          d3.select("#svg3")
            .append("rect")
            .attr("rx", 1)
            .attr("height", 26)
            .attr("width", (53 * 260) / 100)
            .attr("y", 20)
            .attr("fill", "#BDBAD7");

          d3.select("#svg3")
            .append("g")
            .selectAll("rect")
            .data(data)
            .enter()
            .append("rect")
            .attr("height", 26)
            .attr("x", (d) => (d * 260) / 100)
            .attr("y", 20)
            .attr("class", (d, i) => color[i])
            .attr("width", 4);
        </script>
      </button>
      <button class="keygraph" value="peace">
        <p class="keyword">평화</p>
        <svg id="svg4"></svg>
        <script src="http://d3js.org/d3.v3.js"></script>
        <script>
          var data = [84.7, 65];
          var color = ["red", "blue"];

          d3.select("#svg4")
            .append("rect")
            .attr("rx", 1)
            .attr("height", 26)
            .attr("width", 260)
            .attr("y", 20)
            .attr("fill", "#CCCCCC");

          d3.select("#svg4")
            .append("rect")
            .attr("rx", 1)
            .attr("height", 26)
            .attr("width", (4 * 260) / 100)
            .attr("y", 20)
            .attr("fill", "#EB8777");

          d3.select("#svg4")
            .append("g")
            .selectAll("rect")
            .data(data)
            .enter()
            .append("rect")
            .attr("height", 26)
            .attr("x", (d) => (d * 260) / 100)
            .attr("y", 20)
            .attr("class", (d, i) => color[i])
            .attr("width", 4);
        </script>
      </button>
      <button class="keygraph" value="partnership">
        <p class="keyword">협력</p>
        <svg id="svg5"></svg>
        <script src="http://d3js.org/d3.v3.js"></script>
        <script>
          var data = [94.4, 73];
          var color = ["red", "blue"];

          d3.select("#svg5")
            .append("rect")
            .attr("rx", 1)
            .attr("height", 26)
            .attr("width", 260)
            .attr("y", 20)
            .attr("fill", "#CCCCCC");

          d3.select("#svg5")
            .append("rect")
            .attr("rx", 1)
            .attr("height", 26)
            .attr("width", (3 * 260) / 100)
            .attr("y", 20)
            .attr("fill", "#8AB0D0");

          d3.select("#svg5")
            .append("g")
            .selectAll("rect")
            .data(data)
            .enter()
            .append("rect")
            .attr("height", 26)
            .attr("x", (d) => (d * 260) / 100)
            .attr("y", 20)
            .attr("class", (d, i) => color[i])
            .attr("width", 4);
        </script>
      </button>
    </article>

    <footer id="keyText">
      <div id="reload">
        <div id="last1">
          <p class="keyGraphName">세종대 핵심 키워드</p>
          <svg id="myGraph1"></svg>
          <script src="https://d3js.org/d3.v4.min.js"></script>
          <script>
            $(".keygraph").click(function(){
              $("#reload").load(window.location.href + " #reload");
              var value = $(this).attr("value");
              if (value == "people") {
                kuni = "kpeople";
              } else if (value == "planet") {
                kuni = "kplanet";
              } else if (value == "prosperity") {
                kuni = "kprosperity";
              } else if (value == "peace") {
                kuni = "kpeace";
              } else if (value == "partnership") {
                kuni = "kpartnership";
              }
  
              d3.csv("CSV/SU/" + kuni + ".csv", function (error, data) {
                var dataSet = []; //데이터를 저장
                var labelName = []; //레이블 저장
                for (var i in data[0]) {
                  dataSet.push(data[0][i]); //가로 줄 넣음
                  labelName.push(i); //레이블 넣음
                }
  
                //SVG요소의 넓이와 높이를 구함
                var svgEle = document.getElementById("myGraph1");
                var svgWidth = 480;
                var svgHeight = 260;
  
                //그래프에 사용할 변수
                var barElements; //막대그래프의 막대 요소를 저장할 변수
                var dataMax = 400; //데이터의 최댓값
                var barHeight = 20; //막대 넓이
                var barMargin = 15; //막대 간격
  
                //그래프 그리기(그래프 옵션)
                barElements = d3.select("#myGraph1")
                                .selectAll("rect") //rect 요소를 지정
                                .data(dataSet); //데이터를 요소에 연결
  
                //데이터가 추가될 때
                barElements.enter() //데이터 개수 만큼 반복
                           .append("rect") //데이터 개수만큼 rect 요소가 추가됨
                           .attr("class", "bar") //CSS 클래스를 지정
                           .attr("width", 0) //초깃값 0으로 설정
                           .attr("height", barHeight) //넓이 지정
                           .attr("x", 88)
                           .attr("y", function (d, i) { //Y좌표 지정
                             return i * (barHeight + barMargin) + barMargin; //처음 Y축과 간격
                           })
  
                           //애니메이션
                           .transition()
                           .duration(800) //애니메이션 처리 시간
                           .delay(function (d, i) { return i * 200; }) //0.4초 대기
                           .attr("x", function (d, i) { return 88; }) //X 좌표를 지정
                           .attr("width", function (d, i) {
                             //넓이설정.2번째의 파라미터에 함수지정
                             return d; //데이터 값을 그대로 넓이로 지정
                           });
  
                //막대의 레이블을 표시
                barElements.enter()
                           .append("text")
                           .attr("class", "barName")
                           .attr("y", function (d, i) { //Y좌표 지정
                             return (i * (barHeight + barMargin) + (barHeight / 2 + barMargin) + 8); }) //막대그래프의 표시 간격을 맞춤
                           .attr("x", 0)
                           .text(function (d, i) { return labelName[i]; }) //레이블 이름을 반환
                           .style("font-family", "Do Hyeon")
                           .style("font-size", 20);
                //Y 방향의 선을 표시
                d3.select("#myGraph1")
                  .append("rect")
                  .attr("class", "axis_y")
                  .attr("height", function(d, i) { return ((barHeight + barMargin) * dataSet.length) + 30; })
                  .attr("width", "1")
                  .attr("x", 88);
                });
            });
          </script>
        </div>
        <div id="last2">
          <p class="keyGraphName">국내 대학 핵심 키워드</p>
          <svg id="myGraph2"></svg>
          <script src="https://d3js.org/d3.v4.min.js"></script>
          <script>
            $(".keygraph").click(function(){
              var value = $(this).attr("value");
              if (value == "people") {
                kouni = "kopeople";
              } else if (value == "planet") {
                kouni = "koplanet";
              } else if (value == "prosperity") {
                kouni = "koprosperity";
              } else if (value == "peace") {
                kouni = "kopeace";
              } else if (value == "partnership") {
                kouni = "kopartnership";
              }
  
              d3.csv("CSV/kotextrank/" + kouni + ".csv", function (error, data) {
                var dataSet = []; //데이터를 저장
                var labelName = []; //레이블 저장
                for (var i in data[0]) {
                  dataSet.push(data[0][i]); //가로 줄 넣음
                  labelName.push(i); //레이블 넣음
                }
              
                //SVG요소의 넓이와 높이를 구함
                var svgEle = document.getElementById("myGraph2");
                var svgWidth = 480;
                var svgHeight = 260;
  
                //그래프에 사용할 변수
                var barElements; //막대그래프의 막대 요소를 저장할 변수
                var dataMax = 400; //데이터의 최댓값
                var barHeight = 20; //막대 넓이
                var barMargin = 15; //막대 간격
  
                //그래프 그리기(그래프 옵션)
                barElements = d3.select("#myGraph2")
                                .selectAll("rect") //rect 요소를 지정
                                .data(dataSet); //데이터를 요소에 연결
  
                //데이터가 추가될 때
                barElements.enter() //데이터 개수 만큼 반복
                           .append("rect") //데이터 개수만큼 rect 요소가 추가됨
                           .attr("class", "bar") //CSS 클래스를 지정
                           .attr("width", 0) //초깃값 0으로 설정
                           .attr("height", barHeight) //넓이 지정
                           .attr("x", 88)
                           .attr("y", function (d, i) { //Y좌표 지정
                             return i * (barHeight + barMargin) + barMargin; //처음 Y축과 간격
                           })
  
                           //애니메이션
                           .transition()
                           .duration(800) //애니메이션 처리 시간
                           .delay(function (d, i) { return i * 200; }) //0.4초 대기
                           .attr("x", function (d, i) { return 88; }) //X 좌표를 지정
                           .attr("width", function (d, i) {
                             //넓이설정.2번째의 파라미터에 함수지정
                             return d; //데이터 값을 그대로 넓이로 지정
                           });
  
                //막대의 레이블을 표시
                barElements.enter()
                           .append("text")
                           .attr("class", "barName")
                           .attr("y", function (d, i) { //Y좌표 지정
                             return (i * (barHeight + barMargin) + (barHeight / 2 + barMargin) + 8); }) //막대그래프의 표시 간격을 맞춤
                           .attr("x", 0)
                           .text(function (d, i) { return labelName[i]; }) //레이블 이름을 반환
                           .style("font-family", "Do Hyeon")
                           .style("font-size", 20);
  
                //Y 방향의 선을 표시
                d3.select("#myGraph2")
                  .append("rect")
                  .attr("class", "axis_y")
                  .attr("height", function(d, i) { return ((barHeight + barMargin) * dataSet.length) + 30; })
                  .attr("width", "1")
                  .attr("x", 88);
              });
  
            });
          </script>
        </div>
        <div id="last3">
          <p class="keyGraphName">해외 대학 핵심 키워드</p>
          <svg id="myGraph3"></svg>
          <script src="https://d3js.org/d3.v4.min.js"></script>
          <script>
            $(".keygraph").click(function(){
              var value = $(this).attr("value");
              if (value == "people") {
                ouni = "opeople";
              } else if (value == "planet") {
                ouni = "oplanet";
              } else if (value == "prosperity") {
                ouni = "oprosperity";
              } else if (value == "peace") {
                ouni = "opeace";
              } else if (value == "partnership") {
                ouni = "opartnership";
              }
  
              d3.csv("CSV/otextrank/" + ouni + ".csv", function (error, data) {
                var dataSet = []; //데이터를 저장
                var labelName = []; //레이블 저장
                for (var i in data[0]) {
                  dataSet.push(data[0][i]); //가로 줄 넣음
                  labelName.push(i); //레이블 넣음
                }
              
                //SVG요소의 넓이와 높이를 구함
                var svgEle = document.getElementById("myGraph3");
                var svgWidth = 480;
                var svgHeight = 260;
  
                //그래프에 사용할 변수
                var barElements; //막대그래프의 막대 요소를 저장할 변수
                var dataMax = 400; //데이터의 최댓값
                var barHeight = 20; //막대 넓이
                var barMargin = 15; //막대 간격
  
                //그래프 그리기(그래프 옵션)
                barElements = d3.select("#myGraph3")
                                .selectAll("rect") //rect 요소를 지정
                                .data(dataSet); //데이터를 요소에 연결
  
                //데이터가 추가될 때
                barElements.enter() //데이터 개수 만큼 반복
                           .append("rect") //데이터 개수만큼 rect 요소가 추가됨
                           .attr("class", "bar") //CSS 클래스를 지정
                           .attr("width", 0) //초깃값 0으로 설정
                           .attr("height", barHeight) //넓이 지정
                           .attr("x", 88)
                           .attr("y", function (d, i) { //Y좌표 지정
                             return i * (barHeight + barMargin) + barMargin; //처음 Y축과 간격
                           })
  
                           //애니메이션
                           .transition()
                           .duration(800) //애니메이션 처리 시간
                           .delay(function (d, i) { return i * 200; }) //0.4초 대기
                           .attr("x", function (d, i) { return 88; }) //X 좌표를 지정
                           .attr("width", function (d, i) {
                             //넓이설정.2번째의 파라미터에 함수지정
                             return d * 4; //데이터 값을 그대로 넓이로 지정
                           });
  
                //막대의 레이블을 표시
                barElements.enter()
                           .append("text")
                           .attr("class", "barName")
                           .attr("y", function (d, i) { //Y좌표 지정
                             return (i * (barHeight + barMargin) + (barHeight / 2 + barMargin) + 8); }) //막대그래프의 표시 간격을 맞춤
                           .attr("x", 0)
                           .text(function (d, i) { return labelName[i]; }) //레이블 이름을 반환
                           .style("font-family", "Do Hyeon")
                           .style("font-size", 20);
  
                //Y 방향의 선을 표시
                d3.select("#myGraph3")
                  .append("rect")
                  .attr("class", "axis_y")
                  .attr("height", function(d, i) { return ((barHeight + barMargin) * dataSet.length) + 30; })
                  .attr("width", "1")
                  .attr("x", 88);
              });
  
            });
          </script>
        </div>
        <p id="last4">
          해외 대학 활동이 뭐닞느니 리린ㄹ ㄴ이ㅏ럼
        </p> 
      </div>
    </footer>

    <script>
      $(".keygraph").click(function(){
        document.getElementById("keyText").style.display = "flex";
      });
    </script>
  </body>
</html>